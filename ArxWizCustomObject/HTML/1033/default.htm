<!-- Copyright (c) Autodesk, Inc. All rights reserved. -->
<HTML DIR="LTR">
	<HEAD>
		<TITLE></TITLE>
		<META content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
    	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
        <META HTTP-EQUIV="MSThemeCompatible" CONTENT="Yes">
    	<LINK ID="LINKURL" REL="stylesheet" HREF="../../../../../1033/NewStyles.css">
	    <SCRIPT>
		    var strURL =window.external.FindSymbol ("PRODUCT_INSTALLATION_DIR") ;
		    strURL +="VCWizards/" ;
		    strURL +=window.external.GetHostLocale () ;
		    strURL +="/NewStyles.css" ;
    	    document.styleSheets ("LINKURL").href =strURL ;
    	</SCRIPT>
		<!--  -->
		<!-- The SYMBOL tag is used to set the default values for the user-defined symbols.-->
		<!--  -->
		<SYMBOL NAME="PROTOCOLS" TYPE="text" VALUE="1"></SYMBOL>
		<SYMBOL NAME="CLASS_NAME_ROOT" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="CLASS_NAME" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="BASE_CLASS" TYPE="text" VALUE="AcDbObject"></SYMBOL>
		<SYMBOL NAME="DXFNAME" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="APPNAME" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="DWG_PROTOCOL" TYPE="bool" VALUE="true"></SYMBOL>
		<SYMBOL NAME="DXF_PROTOCOL" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="OSNAP_PROTOCOL" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="GRIPPOINT_PROTOCOL" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="IMPL_VIEWPORT" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="CURVE_PROTOCOL" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="PERSISTENT_REACTOR" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="SELF_REACTOR" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="DEEPCLONE" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="WBLOCKCLONE" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="HEADER_FILE" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="IMPL_FILE" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="HEADER_FILE_VALID" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="IMPL_FILE_VALID" TYPE="bool" VALUE="false"></SYMBOL>
		<SYMBOL NAME="INCLUDE_HEADER" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="AUTOMATION_NONE" TYPE="radio" VALUE="true"></SYMBOL>
		<SYMBOL NAME="AUTOMATION" TYPE="radio" VALUE="false"></SYMBOL>
		<SYMBOL NAME="TEMPLATE_HEADER" TYPE="text" VALUE="object.h"></SYMBOL>
		<SYMBOL NAME="TEMPLATE_IMPL" TYPE="text" VALUE="object.cpp"></SYMBOL>
		<SYMBOL NAME="MERGE_FILE" TYPE="bool" VALUE="false"></SYMBOL>
	</HEAD>
	<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">
		<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="178">
			<COL>
			<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
			<TR VALIGN="TOP">
				<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
					<TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<COL WIDTH="12">
						<COL>
						<COL WIDTH="12">
						<TR>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
								&nbsp;
							</TD>
							<TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
								<DIV CLASS="SMALLA" ID="Layer0">
									<IMG CLASS="SMALLEST" SRC="../../Images/CustomObject.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
								</DIV>
							</TD>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
								&nbsp;
							</TD>
						</TR>
						<TR>
							<TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="65">
								<H4 CLASS="HEAD" ID="HEAD">Welcome</H4>
							</TD>
							<TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
								&nbsp;
							</TD>
						</TR>
						<TR>
							<TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
								<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
									<TR VALIGN="TOP">
										<TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
										<TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
									</TR>
								</TABLE>
							</TD>
						</TR>
					</TABLE>
				</TD>
			</TR>
			<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
			<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
			<TR VALIGN="TOP">
				<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="100%">
					<TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<TR VALIGN="TOP">
							<TD CLASS="threeCustom" VALIGN="TOP" STYLE="BACKGROUND-IMAGE: URL(../../Images/CustomObjectBG.gif);">
								<!--OPEN OF NAVIGATION TABLE//-->
								<TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
									<COL WIDTH="12">
									<COL WIDTH="166">
									<COL WIDTH="1">
									<TR>
										<TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
											&nbsp;
										</TD>
									</TR>
									<TR height="85%">
										<TD VALIGN="TOP" WIDTH="12">
											&nbsp;
										</TD>
										<TD VALIGN="TOP" WIDTH="165">
											<!--OPEN OF NAVIGATIONAL LINKS//-->
											<DIV CLASS="LINKSELECTED">
												<SPAN CLASS="VERTLINE1"><IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
												</SPAN><SPAN CLASS="HORILINE1">
													<TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
														<TR VALIGN="TOP">
															<TD CLASS="DOTTEDLINE" HEIGHT="1">
															</TD>
														</TR>
														<TR VALIGN="TOP">
															<TD HEIGHT="100%">
																<IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
															</TD>
														</TR>
														<TR VALIGN="TOP">
															<TD CLASS="DOTTEDLINE" HEIGHT="1">
															</TD>
														</TR>
													</TABLE>
												</SPAN>
												<TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
													<TR VALIGN="MIDDLE">
														<TD WIDTH="156">
															<SPAN ID="Default" TITLE="Specify class and file names as well as type of class to create." onclick="DisplayAboutBox(false);">
																Names</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
											<DIV CLASS="LINK">
												<TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
													<TR VALIGN="MIDDLE">
														<TD WIDTH="162">
															<SPAN CLASS="ACTIVELINK" ID="Protocols" TITLE="Specify basic Protocols to be supported in your custom object." onClick="DisplayAboutBox(false);if (this.className.toLowerCase() == 'inactivelink') return; Next(document, 'Protocols.htm');" TABINDEX="1">
																Protocols</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
											<DIV CLASS="LINK">
												<TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT" ID="Table1">
													<TR VALIGN="MIDDLE">
														<TD WIDTH="162">
															<SPAN CLASS="ACTIVELINK" ID="Advanced" TITLE="" onClick="DisplayAboutBox(false);Next(document, 'Advanced.htm');">
																Advanced</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
											<!--CLOSE OF NAVIGATIONAL LINKS//-->
										</TD>
										<TD WIDTH="1">
											<DIV CLASS="VERTLINE">
												<IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
											</DIV>
										</TD>
									</TR>
									<TR>
										<TD VALIGN="top" WIDTH="12">&nbsp;</TD>
										<TD VALIGN="top" WIDTH="165">
											<DIV>
												<TABLE WIDTH="166" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT" ID="Table2">
													<TR VALIGN="center">
														<TD WIDTH="162">
															<SPAN CLASS="ACTIVELINK" ID="ABOUT" TITLE="" onclick="DisplayAboutBox(true);" TABINDEX="1">
																About...</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
										</TD>
										<TD WIDTH="1">
											<DIV CLASS="VERTLINE">
												<IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
											</DIV>
										</TD>
									</TR>
								</TABLE>
							</TD>
						</TR>
					</TABLE>
					<!--CLOSE OF NAVIGATION TABLE//-->
				</TD>
				<TD VALIGN="TOP" HEIGHT="100%">
					<!--OPEN OF CONTENT AND BUTTON TABLE//-->
					<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<COL WIDTH="100%">
						<TR VALIGN="TOP">
							<TD HEIGHT="100%">
								<!--OPEN OF CONTENT//-->
								<div id="about" style="visibility:hidden; display:none;">
									<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%" ID="Table3">
										<tr>
											<td colspan="5" height="12"><IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1"></td>
										</tr>
										<tr height="12">
											<td width="12" rowspan="10"><IMG SRC="../../Images/spacer.gif" WIDTH="12" HEIGHT="1"></td>
											<td colspan="3"><b><font size="2"><span id="ABOUTTITLE"></span></font></b></td>
											<td width="12" rowspan="10"><IMG SRC="../../Images/spacer.gif" WIDTH="12" HEIGHT="1"></td>
										</tr>
										<tr height="12">
											<td colspan="3" id="ABOUTVERSION">Version: </td>
										</tr>
										<tr height="12">
											<td colspan="3">Copyright © Autodesk, Inc. All rights reserved.</td>
										</tr>
										<tr>
											<td colspan="3" height="25"><IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1"></td>
										</tr>
										<tr height="12">
											<td width="30"></td>
											<td colspan="2"><b><u>by Autodesk Developer Technical Services</u></b></td>
										</tr>
										<tr height="12">
											<td></td>
											<td width="5"></td>
											<td><b>Cyrille Fauvel</b></td>
										</tr>
										<tr height="12">
											<td></td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td colspan="3" height="25" width="100%"><IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1"></td>
										</tr>
										<tr height="12">
											<td colspan="3">Updates freely available to ADN members on: <a href="http://adn.autodesk.com">
													<font color="blue">http://adn.autodesk.com</font></a></td>
										</tr>
										<tr height="12">
											<td colspan="3">Email wishlist items, and bug reports to: <a href="mailto:oarxwiz-feedback@autodesk.com">
													<font color="blue">oarxwiz-feedback@autodesk.com</font></a></td>
										</tr>
										<tr>
											<td colspan="5">&nbsp;</td>
										</tr>
									</table>
								</div>
								<div id="content">
									<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
										<COL WIDTH="12">
										<COL WIDTH="193">
										<COL WIDTH="12">
										<COL WIDTH="193">
										<COL WIDTH="12">
										<TR>
											<TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
												&nbsp;
											</TD>
										</TR>
										<TR>
											<TD VALIGN="TOP" WIDTH="12">
												&nbsp;
											</TD>
											<TD VALIGN="TOP">
												<SPAN CLASS="itemTextTop" ID="CLASS_NAME_SPAN" TITLE="Name of new class that will be created.">
													<LABEL FOR="CLASS_NAME" ID="CLASS_NAME_LABEL">C<U>l</U>ass name:</LABEL>
													<BR>
													<INPUT CLASS="sideBtn" ID="CLASS_NAME" TYPE="text" ACCESSKEY="l" VALUE="" onPropertychange="OnClass();">
												</SPAN>
												<P CLASS="ElementSpacer16">&nbsp;</P>
												<SPAN CLASS="itemText" ID="BASE_CLASS_SPAN" TITLE="Name of class that new class will derive from.">
													<LABEL FOR="BASE_CLASS" ID="BASE_CLASS_LABEL"><U>B</U>ase class:</LABEL>
													<BR>
													<SELECT CLASS="sideBtn" ID="BASE_CLASS" SIZE="1" ACCESSKEY="b" onChange="OnBase();">
													</SELECT>
												</SPAN>
												<P CLASS="ElementSpacer6">&nbsp;</P>
												<NOBR><SPAN CLASS="itemText" ID="HEADER_FILE_SPAN" TITLE="Name of header file where class will be defined.">
														<LABEL FOR="HEADER_FILE" ID="HEADER_FILE_LABEL">.h f<U>i</U>le:</LABEL>
														<BR>
														<INPUT CLASS="sideBtn2" ID="HEADER_FILE" ACCESSKEY="i" NAME="IsapiDirectoryName" TYPE="text" onPropertychange="window.external.AddSymbol('HEADER_FILE_VALID', false);">
														<BUTTON CLASS="buttonClass3Custom" ID="BrowseHeaderBtn" TYPE="BUTTON" TITLE="Browse for header file." onClick="OnBrowseHeaderFile();">
															...</BUTTON> </SPAN></NOBR>
												<P CLASS="ElementSpacer6">&nbsp;</P>
												<NOBR><SPAN CLASS="itemText" ID="IMPL_FILE_SPAN" TITLE="Name of implementation file for this class.">
														<LABEL FOR="IMPL_FILE" ID="IMPL_FILE_LABEL">.c<U>p</U>p file:</LABEL>
														<BR>
														<INPUT CLASS="sideBtn2" ID="IMPL_FILE" ACCESSKEY="p" TYPE="text" onPropertychange="window.external.AddSymbol('IMPL_FILE_VALID', false);">
														<BUTTON CLASS="buttonClass3Custom" ID="BrowseImplBtn" TYPE="BUTTON" TITLE="Browse for implementation file." onClick="OnBrowseImplFile();">
															...</BUTTON> </SPAN></NOBR>
											</TD>
											<TD VALIGN="TOP" WIDTH="12">
												&nbsp;
											</TD>
											<TD VALIGN="TOP">
												<SPAN CLASS="itemTextTop" ID="DXFNAME_SPAN" TITLE="DXF Name"><LABEL FOR="DXFNAME" ID="DXFNAME_LABEL">
														D<U>X</U>F Name:</LABEL>
													<BR>
													<INPUT CLASS="sideBtn" ID="DXFNAME" TYPE="text" ACCESSKEY="X"> </SPAN>
												<P CLASS="ElementSpacer16">&nbsp;</P>
												<SPAN CLASS="itemText" ID="APPNAME_SPAN" TITLE="Logical Application Name"><LABEL FOR="APPNAME" ID="APPNAME_LABEL">
														<U>L</U>ogical Application Name:</LABEL>
													<BR>
													<INPUT CLASS="sideBtn" ID="APPNAME" ACCESSKEY="L" TYPE="text"> </SPAN>
												<P CLASS="ElementSpacer16">&nbsp;</P>
												<SPAN CLASS="itemText"><SPAN CLASS="itemText" ID="automation_options_title">Automation 
														Support:</SPAN>
													<P CLASS="Spacer">&nbsp;</P>
													<SPAN ID="AUTOMATION_NONE_SPAN" TITLE="Class doesn't support automation."><INPUT TYPE="radio" CLASS="Radio" NAME="automation" ID="AUTOMATION_NONE" ACCESSKEY="n">
														<DIV CLASS="itemTextRadioB">
															<LABEL FOR="AUTOMATION_NONE" ID="AUTOMATION_NONE_LABEL"><U>N</U>one</LABEL>
														</DIV>
													</SPAN>
													<BR>
													<SPAN ID="AUTOMATION_SPAN" TITLE="Class supports automation."><INPUT TYPE="radio" CLASS="Radio" NAME="automation" ID="AUTOMATION" ACCESSKEY="A">
														<DIV CLASS="itemTextRadioB">
															<LABEL FOR="AUTOMATION" ID="AUTOMATION_LABEL"><U>A</U>utomation</LABEL>
														</DIV>
													</SPAN></SPAN>
											</TD>
											<TD VALIGN="TOP" WIDTH="12">
												&nbsp;
											</TD>
										</TR>
										<TR>
											<TD VALIGN="TOP" HEIGHT="100%" COLSPAN="3">
												&nbsp;
											</TD>
										</TR>
									</TABLE>
								</div>
								<!--CLOSE OF CONTENT//-->
							</TD>
						</TR>
						<TR VALIGN="BOTTOM">
							<TD HEIGHT="48">
								<!--OPEN OF BUTTON HTML//-->
								<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
									<COL WIDTH="12">
									<COL>
									<COL WIDTH="75">
									<COL WIDTH="4">
									<COL WIDTH="75">
									<COL WIDTH="4">
									<COL WIDTH="75">
									<COL WIDTH="12">
									<TR>
										<TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
											<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
												<TR VALIGN="TOP">
													<TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
													<TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
												</TR>
											</TABLE>
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
											&nbsp;
										</TD>
										<TD VALIGN="TOP" HEIGHT="23">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">
												Cancel</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="InvokeArxWizardHelp();">Help</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
											&nbsp;
										</TD>
									</TR>
								</TABLE>
								<!--CLOSE OF BUTTON HTML//-->
							</TD>
						</TR>
					</TABLE>
					<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
				</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>
<SCRIPT LANGUAGE="JSCRIPT">

var tab_array =new Array () ;
tab_array [0] =Default ;
tab_array [1] =Protocols ;
tab_array [2] =Advanced ;

var xmlDoc =new ActiveXObject ("Msxml2.DOMDocument") ;

function InitDocument (document) {
	setDirection () ;
	
	if ( IsValidAdeskProject (window.external.ProjectObject, 15 /*dbx | arx | host | crx*/) == false ) {
		window.external.Finish (document, 'cancel') ;
		return ;
	}
	
	if (   window.external.FindSymbol ("NOT_FIRST_TIME") == null
		&& IsValidAdeskProject (window.external.ProjectObject, 14 /*arx | dhost | crx*/) == true
	) {
		var L_Msg ="Custom Object should be implemented in .DBX project.\nAre you sure you want to continue?" ;
		if ( window.external.YesNoAlert (L_Msg) == false ) {
			window.external.Finish (document, 'cancel') ;
			return ;
		}
		window.external.AddSymbol ("NOT_FIRST_TIME", true) ;
	}
	
	var rds =GetRDSValue () ;
	//- Set the label for Class Name
	CLASS_NAME_LABEL.innerHTML ="C<U>l</U>ass name: (Project RDS prefix: " + rds + ")" ;
	//- Other texts
	HEAD.innerText ="Welcome to the " + szArxWizObjectTitle ;
	
	if ( window.external.FindSymbol ("DOCUMENT_FIRST_LOAD") ) {
		window.external.AddSymbol ("WIZARD_DIALOG_TITLE", szArxWizObjectTitle) ;
		window.external.SetDefaults (document) ;
		var strProjName =window.external.FindSymbol ("PROJECT_NAME") ;
		var strSafeProjName =CreateSafeName (strProjName) ;
		window.external.AddSymbol ("SAFE_PROJECT_NAME", strSafeProjName) ;
		window.external.AddSymbol ("CLASS_NAME", rds) ;
		window.external.AddSymbol ("APPNAME", rds.toUpperCase () + strSafeProjName.toUpperCase () + "APP") ;
	}

	xmlDoc.async =false ;
	xmlDoc.load ("dbxobjects.xml") ;
	PopulateBaseList () ;
	
	window.external.Load (document) ;

	OnBase () ;
}

function PopulateBaseList () {
	//- Read from an XML file (create a dom document)
	//var msDomQuery =".//object[@flag = 'X']" ;
	var msDomQuery =".//dbxobject" ;
	var moNodList =xmlDoc.selectNodes (msDomQuery) ;
	
	for ( var nCtr =0 ; nCtr < moNodList.length ; nCtr++ ) {
		if ( moNodList.item (nCtr).getAttribute ("flag") != "X" ) {
			var msBaseClass =moNodList.item (nCtr).getAttribute ("name") ;
			var oOption =document.createElement ("OPTION") ;
			oOption.text =msBaseClass ;
			oOption.value =msBaseClass ;
			BASE_CLASS.add (oOption) ;
		}	
	}
	BASE_CLASS.selectedIndex =0 ;
}

function GetAttribute (msBaseClass, msAttribute) {
	try {
		var poNode =xmlDoc.selectSingleNode (".//dbxobject[@name = '" + msBaseClass + "']") ;
		return (poNode.getAttribute (msAttribute)) ;
	} catch ( e ) {
		return (false) ;
	}
}

function OnClass () {
	var strClassName =CLASS_NAME.value ;
	if ( strClassName.length == 0 || (strClassName.length == 1 && (strClassName.charAt (0) == "C" || strClassName.charAt (0) == "c")) ){
		HEADER_FILE.value ="" ;
		IMPL_FILE.value ="" ;
		DXFNAME.value ="" ;
	} else {
		if ( strClassName.charAt (0) == "C" || strClassName.charAt (0) == "c" ) {
			HEADER_FILE.value =strClassName.substr (1) + ".h" ;
			IMPL_FILE.value =strClassName.substr (1) + ".cpp" ;
			DXFNAME.value =strClassName.substr (1).toUpperCase () ;
		} else {
			HEADER_FILE.value =strClassName + ".h" ;
			IMPL_FILE.value =strClassName + ".cpp" ;
			DXFNAME.value=strClassName.toUpperCase () ;
		}
	}
}

function OnBase () {
	var strBaseClass =BASE_CLASS.options [BASE_CLASS.selectedIndex].value ;
	AUTOMATION_NONE.checked =true ;
	
	var protocols =GetAttribute (strBaseClass, "protocol") ;
	window.external.AddSymbol ("PROTOCOLS", protocols) ;
}

function SetSymbols () {
	var strBaseClass =BASE_CLASS.options [BASE_CLASS.selectedIndex].value ;

	var strTemplateHeader =GetAttribute (strBaseClass, "templatefile") + ".h" ;
	var strTemplateImpl =GetAttribute (strBaseClass, "templatefile") + ".cpp" ;
	var strIncludeHeader =GetAttribute (strBaseClass, "header") ;
	window.external.AddSymbol ("TEMPLATE_HEADER", strTemplateHeader) ;
	window.external.AddSymbol ("TEMPLATE_IMPL", strTemplateImpl) ;
	window.external.AddSymbol ("INCLUDE_HEADER", strIncludeHeader) ;

	var strClassName =CLASS_NAME.value ;
	var strSafeClassName =CreateSafeName (strClassName) ;
	if ( strSafeClassName.substr (0, 1) == "C" )
		strSafeClassName =strSafeClassName.substr (1, strSafeClassName.length) ;
	window.external.AddSymbol ("CLASS_NAME_ROOT", strSafeClassName) ;
}

function OnBrowseHeaderFile () {
	var strFile ;
	try {
		L_Title1_Text ="VS Wizards Select File";
		L_Title2_Text ="Visual C++ Header Files (*.h)\0*.h\0\0" ;
		strFile =window.external.GetOpenFileNameViaDlg (L_Title1_Text, window.external.FindSymbol ("PROJECT_PATH"),  L_Title2_Text, HEADER_FILE.value) ;
	} catch( e ) {
		if ( e.number != OLE_E_PROMPTSAVECANCELLED ) {
			var L_ErrMsg1_Text ="Error in OnBrowseHeaderFile()" ;
			if ( e.description.length != 0 ) {
				L_ErrMsg1_Text +=": " ;
				L_ErrMsg1_Text +=e.description ;
			}
			window.external.ReportError (L_ErrMsg1_Text) ;
		}
		return ;
	}
	HEADER_FILE.value =strFile ;
}

function OnBrowseImplFile () {
	var strFile ;
	try {
		L_Title3_Text ="VS Wizards Select File" ;
		L_Title4_Text ="Visual C++ Files (*.cpp;*.h;*.inl;*.c)\0*.cpp;*.h;*.inl;*.c\0\0" ;
		strFile =window.external.GetOpenFileNameViaDlg (L_Title3_Text, window.external.FindSymbol ("PROJECT_PATH"), L_Title4_Text, IMPL_FILE.value) ;
	} catch ( e ) {
		if ( e.number != OLE_E_PROMPTSAVECANCELLED ) {
			var L_ErrMsg2_Text ="Error in OnBrowseImplFile()" ;
			if ( e.description.length != 0 ) {
				L_ErrMsg2_Text +=": " ;
				L_ErrMsg2_Text +=e.description ;
			}
			window.external.ReportError (L_ErrMsg2_Text) ;
		}
		return ;
	}
	IMPL_FILE.value =strFile ;
}

function ValidateInput () {
	var oInvalid =null ;
	if ( !Validate (CLASS_NAME) )
		oInvalid =CLASS_NAME ;
	if ( oInvalid == null )
		if ( !Validate (BASE_CLASS) )
			oInvalid =BASE_CLASS ;
	if ( oInvalid == null )
		if ( !Validate (DXFNAME) )
			oInvalid =DXFNAME ;
	if ( oInvalid == null )
		if ( !Validate (APPNAME) )
			oInvalid =APPNAME ;
	if ( oInvalid == null )
		if ( !Validate (HEADER_FILE) )
			oInvalid =HEADER_FILE ;
	if ( oInvalid == null )
		if ( !Validate (IMPL_FILE) )
			oInvalid =IMPL_FILE ;
	if ( oInvalid != null ) {
		if ( gbShowError )
			window.external.ReportError () ;
		else
			gbShowError =true ;
		oInvalid.focus () ;
		return (false) ;
	}
	return (true) ;
}

var gbShowError =true ;

function Validate (obj) {
	var bValid =true ;
	switch ( obj.id ) {
		case "CLASS_NAME":
			bValid =window.external.ParentObject.ValidateMember (obj.value, vsCMElementClass) ;
			break ;
		case "BASE_CLASS":
			if ( BASE_CLASS.selectedIndex == -1 ) {
				SetErrorInfo (new Error ("Select a base class.")) ;
				bValid =false ;
			}
			break ;
		case "DXFNAME":
			if ( DXFNAME.value == "" ) {
				SetErrorInfo (new Error ("Give a DXF name to your new object.")) ;
				bValid =false ;
			}
            break ;
		case "APPNAME":
			if ( APPNAME.value == "" ) {
				SetErrorInfo (new Error ("Give a APPNAME to your new object.")) ;
				bValid =false ;
			}
			break ;
		case "HEADER_FILE":
			if ( !window.external.FindSymbol ("HEADER_FILE_VALID") ) {
				gbShowError =bValid =CanUseFileName (obj.value, true) ;
				if ( !bValid )
					break ;
				window.external.AddSymbol ("HEADER_FILE_VALID", true) ;
			}
			bValid =ValidateFileNameAndEnsureInProject (obj.value) ;
			if ( !bValid )
				break ;
			if ( HEADER_FILE.value == IMPL_FILE.value ) {
				var L_ErrMsg_Text ="Header and implementation files cannot have the same name." ;
				oErrObj =new Error (L_ErrMsg_Text) ;
				SetErrorInfo (oErrObj) ;
				bValid =false ;
			}
			break ;
		case "IMPL_FILE":
			if ( !window.external.FindSymbol ("IMPL_FILE_VALID") ) {
				gbShowError =bValid =CanUseFileName (obj.value, false, false, true) ;
				if ( !bValid )
					break ;
				window.external.AddSymbol ("IMPL_FILE_VALID", true) ;
			}
			bValid =ValidateFileNameAndEnsureInProject (obj.value, vsCMValidateFileExtCppSource) ;
			break ;
		default:
			break ;
	}

	if ( typeof (bValid) == "undefined" )
		bValid =false ;

	return (bValid) ;
}

function DisplayAboutBox (flag) {
	if ( flag == true ) {
		content.style.visibility ="hidden" ;
		content.style.display ="none" ;
		about.style.display ="block" ;
		about.style.visibility ="visible" ;
		ABOUTTITLE.innerText =szArxWizObjectTitle ;
		ABOUTVERSION.innerText ='Version: ' + szWizardsVersion ;
	} else {
		about.style.display ="none" ;
		content.style.display ="block" ;
		content.style.visibility ="visible" ;
		about.style.visibility ="hidden" ;
	}
}

function Next (document, linkto) {
	if ( CLASS_NAME.value.length && !ValidateInput () )
		return ;
	SetSymbols () ;
	window.external.Next (document, linkto) ;
}

function OnFinish (document) {
	if ( !ValidateInput () )
		return ;
	SetSymbols () ;
	OnWizFinish (document) ;
}

</SCRIPT>
<SCRIPT language="JSCRIPT" id="INCLUDE_SCRIPT"></SCRIPT>
<SCRIPT language="JSCRIPT" id="INCLUDE_COMMON"></SCRIPT>
<SCRIPT language="JSCRIPT" id="INCLUDE_ARXCOMMON"></SCRIPT>
<SCRIPT>
document.scripts ("INCLUDE_SCRIPT").src =window.external.FindSymbol ("SCRIPT_COMMON_PATH") + "/Script.js" ;
document.scripts ("INCLUDE_COMMON").src =window.external.FindSymbol ("SCRIPT_COMMON_PATH") + "/Common.js" ;

var strPath =window.external.FindSymbol ("ABSOLUTE_PATH") ;
strPath =strPath.substring (0, strPath.lastIndexOf ("\\") + 1) ;
document.scripts ("INCLUDE_ARXCOMMON").src =strPath + "ArxWizCommon/arxCommon.js" ;
</SCRIPT>
